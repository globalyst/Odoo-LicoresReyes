<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>
	
	<!-- VISTA DE ORDENES DE VENTA, PESTANA DE OFERTAS -->
	<record id="offer_sale_order_form_view" model="ir.ui.view">
		<field name="name">sale.order.form</field>
		<field name="model">sale.order</field>
		<field name="inherit_id" ref="sale.view_order_form"/>
		<field name="arch" type="xml">
			<xpath expr="//page[@string='Order Lines']" position='after'>
				<page string='Ofertas'>
	    			<field name="offers_lines">
						<tree string="Lineas de Ofertas"> 
							<field name="offer_ref"/>
							<field name="accumulations"/>
							<field name="is_active"/>
						</tree>
					</field>
					<button name="onchange_offers_lines" type="object" string="Aplicar Ofertas" class="oe_highlight" />
				</page>
			</xpath>
			<xpath expr="//field[@name='order_line']" position='after'>
				<button name="onchange_offers_lines" type="object" string="Aplicar Ofertas" class="oe_highlight" />
			</xpath>
		</field>
	</record>

	<!-- OFERTAS -->
		<!-- VISTA DE FORMULARIO -->
		<record model="ir.ui.view" id="offer_form_view">
		    <field eval="1" name="sequence"/>
			<field name="name">offer.form</field>
			<field name="model">offer</field>
			<field name="type">form</field>
			<field name="arch" type="xml">
				<form string="Formulario de Ofertas">
					<sheet>
						<group>
							<field name="name"/>
						</group>
						<group>
						    <field name="is_active"/>
							<field name="start_date"/>
							<field name="end_date"/>
						</group>
						<group>
							<field name="supplier_pay"/>
							<field name="max_accumulations"/>
						</group>
						<notebook>
							<page string="Nueva precondición">
								<field name="precondition_id">
									<tree string="Linea"> 
										<field name="name"/>
										<field name="qty_min"/>
										<field name="price_min"/>
										<field name="preconditionline_id"/>
										<field name="offer_id"/>										
									</tree>
								</field>
							</page>
							<page string="Nuevo regalo">
								<field name="gift_id">
									<tree string="Linea"> 
										<field name="name"/>
										<field name="giftline_id"/>
										<field name="offer_id"/>
									</tree>
								</field>
							</page>
						</notebook>
					</sheet>
				</form>
			</field>
		</record>
	
		<!-- VISTA DE ÁRBOL -->
		<record model="ir.ui.view" id="offer_tree_view">
		    <field name="sequence" eval="0"/>
            <field name="name">offer.tree</field>
            <field name="model">offer</field>
            <field name="arch" type="xml">
                <tree string="Precondiciones">
                    <field name="name"/>
					<field name="is_active"/>
					<field name="supplier_pay"/>
					<field name="max_accumulations"/>
				    <field name="start_date"/>
					<field name="end_date"/>
                </tree>
            </field>
        </record>
		
		<!-- ACCIÓN PARA EL BOTÓN DE OFERTAS -->
		<record id="offer_action" model="ir.actions.act_window">
				<field name="name">Ofertas</field>
				<field name="type">ir.actions.act_window</field>
				<field name="res_model">offer</field>
				<field name="view_type">form</field>
				<field name="view_mode">tree,form</field>	
				<field name="context">
					{'search_default_pricelist_type_id':1}
				</field>
		</record>
		
		<!-- BOTÓN DE OFERTAS -->
		<menuitem id="offer_mi" name="Ofertas"
				action="offer_action"
				sequence="6" parent="product.menu_product_pricelist_main"
				groups="product.group_sale_pricelist">
		</menuitem>
	<!-- PRECONDICIONES -->
		<!-- VISTA DE FORMULARIO -->
		<record model="ir.ui.view" id="offer_precondition_form_view">
		    <field eval="1" name="sequence"/>
			<field name="name">offer.precondition.form</field>
			<field name="model">offer.precondition</field>
			<field name="type">form</field>
			<field name="arch" type="xml">
				<form string="Formulario de precondicion">
					<sheet>
						<group>
							<field name="name"/>
						</group>
						<group>
							<field name="qty_min"/>
							<field name="price_min"/>
						</group>
						<notebook>
							<page string="Nuevo elemento de precondición">
								<field name="preconditionline_id">
									<tree string="Linea"> 
										<field name="paid_product"/>
										<field name="qty_min"/>
										<field name="price_min"/>
									</tree>
								</field>
							</page>
						</notebook>
					</sheet>
				</form>
			</field>
		</record>
		
		<!-- VISTA DE ÁRBOL -->
		<record model="ir.ui.view" id="offer_precondition_tree_view">
		    <field name="sequence" eval="0"/>
            <field name="name">offer.precondition.tree</field>
            <field name="model">offer.precondition</field>
            <field name="arch" type="xml">
                <tree string="Precondiciones">
                    <field name="name"/>
					<field name="qty_min"/>
					<field name="price_min"/>
				    <field name="preconditionline_id"/>
                </tree>
            </field>
        </record>
		
		<!-- ACCIÓN PARA EL BOTÓN DE PRECONDICIONES -->
		<record id="offer_precondition_action" model="ir.actions.act_window">
				<field name="name">Precondiciones</field>
				<field name="type">ir.actions.act_window</field>
				<field name="res_model">offer.precondition</field>
				<field name="view_type">form</field>
				<field name="view_mode">tree,form</field>	
				<field name="context">
					{'search_default_pricelist_type_id':1}
				</field>
		</record>
		
		<!-- BOTÓN DE PRECONDICIONES -->
		<menuitem id="precondition_mi" name="Precondiciones"
				action="offer_precondition_action"
				sequence="6" parent="offer_mi"
				groups="product.group_sale_pricelist">
		</menuitem>
		
    <!-- LINEAS DE PRECONDICION -->
	
		<!-- VISTA DE FORMULARIO -->
		<record model="ir.ui.view" id="offer_preconditionline_form">
            <field name="name">offer.precondition.line.form</field>
            <field name="model">offer.precondition.line</field>
            <field name="arch" type="xml">
                <form string="Linea de precondicion">
                    <sheet>
                        <group>
                            <field name="paid_product"/>
                            <field name="qty_min"/>
							<field name="price_min"/>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>
   
    <!-- REGALOS -->
	
		<!-- VISTA DE FORMULARIO -->
		<record model="ir.ui.view" id="offer_gift_form_view">
		    <field eval="1" name="sequence"/>
			<field name="name">offer.gift.form</field>
			<field name="model">offer.gift</field>
			<field name="type">form</field>
			<field name="arch" type="xml">
				<form string="Formulario de regalos">
					<sheet>
						<group>
							<field name="name"/>
						</group>
						<notebook>
							<page string="Nuevo elemento de regalo">
								<field name="giftline_id">
									<tree string="Linea"> 
										<field name="free_product"/>
										<field name="qty"/>
										<field name="fix_price"/>
									</tree>
								</field>
							</page>
						</notebook>
					</sheet>
				</form>
			</field>
		</record>
		
		<!-- VISTA DE ÁRBOL -->
		<record model="ir.ui.view" id="offer_gift_tree_view">
		    <field name="sequence" eval="0"/>
            <field name="name">offer.gift.tree</field>
            <field name="model">offer.gift</field>
            <field name="arch" type="xml">
                <tree string="Regalos">
                    <field name="name"/>
				    <field name="giftline_id"/>
                </tree>
            </field>
        </record>
	
		<!-- ACCIÓN PARA EL BOTÓN DE REGALOS -->
		<record id="offer_gift_action" model="ir.actions.act_window">
				<field name="name">Regalos</field>
				<field name="type">ir.actions.act_window</field>
				<field name="res_model">offer.gift</field>
				<field name="view_type">form</field>
				<field name="view_mode">tree,form</field>	
				<field name="context">
					{'search_default_pricelist_type_id':1}
				</field>
		</record>
		
		<!-- BOTÓN DE PRECONDICIONES -->
		<menuitem id="gift_mi" name="Regalos"
				action="offer_gift_action"
				sequence="6" parent="offer_mi"
				groups="product.group_sale_pricelist" >
		</menuitem>
		
   <!-- LINEAS DE REGALOS -->
   

  		<!-- VISTA DE FORMULARIO -->
		<record model="ir.ui.view" id="offer_giftline_form">
            <field name="name">offer.gift.line.form</field>
            <field name="model">offer.gift.line</field>
            <field name="arch" type="xml">
                <form string="Linea de precondicion">
                    <sheet>
                        <group>
                            <field name="free_product"/>
                            <field name="qty"/>
							<field name="fix_price"/>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>
		
	<!-- ORDER LINE  -->	
	
		<!-- VISTA DE ÁRBOL -->
		<record model="ir.ui.view" id="sale_orderline_tree">
            <field name="name">sale.order.line.tree</field>
            <field name="model">sale.order.line</field>
            <field name="arch" type="xml">
                <tree string="Ordenes de Venta">
                            <field name="product_id"/>
                            <field name="price_unit"/>
							<field name="product_uom_qty"/>
							<field name="price_subtotal"/>
                </tree>
            </field>
        </record>
		
		<!-- ACCIÓN PARA EL BOTÓN DE REGALOS -->
		<record id="orderline_action" model="ir.actions.act_window">
				<field name="name">Orden de Venta</field>
				<field name="type">ir.actions.act_window</field>
				<field name="res_model">sale.order.line</field>
				<field name="view_type">form</field>
				<field name="view_mode">tree,form</field>	
				<field name="context">
					{'search_default_pricelist_type_id':1}
				</field>
		</record>
		
		<!-- BOTÓN DE PRECONDICIONES -->
		<menuitem id="saleorder_mi" name="Orden de Venta"
				action="orderline_action"
				sequence="7" parent="offer_mi"
				groups="product.group_sale_pricelist" >
		</menuitem>
		
   </data>
</openerp>